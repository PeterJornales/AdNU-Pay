<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <link rel="stylesheet" href="./global.css" />
    <link rel="stylesheet" href="./transaction.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;500;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" />
</head>
<body>
    <div class="transaction12">
        <div class="container2">
            <img class="grad-icon6" alt="" src="./public/grad.svg" />
            <div class="container-inner"></div>
            <div class="sub-header">
                <div class="name6">Payment For</div>
                <div class="type">Type</div>
                <div class="date">Date</div>
                <div class="status">Status</div>
                <div class="amount">Amount</div>
            </div>
            <b class="payment-history">Payment History</b>
            <div id="transactionHistory" class="transaction-history"></div>
        </div>
        <div class="extra6">
            <div class="transaction13">Transaction</div>
            <img class="profile-icon6" alt="" src="./public/profile@2x.png" id="profileIcon" />
            <div class="welcome1"></div>
            <div class="extra-child3"></div>
        </div>
        <div class="sidebar6">
            <div class="background6"></div>
            <div class="adnupay-ver01beta6">AdNUPay ver0.1beta</div>
            <div class="hover6"></div>
            <div class="settings19" id="settingsContainer">
                <div class="settings20">Settings</div>
                <div class="rectangle-parent3">
                    <div class="group-child24"></div>
                    <div class="group-child25"></div>
                    <div class="group-child26"></div>
                    <div class="group-child27"></div>
                </div>
            </div>
            <div class="transaction14">
                <div class="transaction15">Transaction</div>
                <img class="transaction-child3" alt="" src="./public/group-41.svg" />
            </div>
            <div class="payment12" id="paymentContainer">
                <div class="payment13">Payment</div>
                <img class="payment-child4" alt="" src="./public/group-3.svg" />
            </div>
            <div class="dashboard13" id="dashboardContainer">
                <div class="dashboard14">Dashboard</div>
                <img class="dashboard-child4" alt="" src="./public/group-21.svg" />
            </div>
            <img class="header-icon6" alt="" src="./public/header@2x.png" id="headerImage" />
        </div>
    </div>

    <script>
        function displayTransactionHistory() {
            var transactions = JSON.parse(localStorage.getItem("transactions")) || [];
            var queueData = JSON.parse(localStorage.getItem("queueData")) || [];
            var transactionHistory = document.getElementById("transactionHistory");

            queueData.forEach(function(queueItem) {
                // If there is a confirmed transaction in the queue, add it to transactions
                transactions.push({
                    paymentFor: queueItem.paymentFor,
                    paymentMethod: "Confirmed", // Assuming confirmed transactions have this payment method
                    date: queueItem.date,
                    status: "Completed",
                    amount: queueItem.amount
                });
            });

            transactions.forEach(function(transaction) {
                var transactionRow = document.createElement("div");
                transactionRow.classList.add("transaction-row");

                transactionRow.innerHTML = `
                    <div class="name6">${transaction.paymentFor}</div>
                    <div class="type">${transaction.paymentMethod}</div>
                    <div class="date">${transaction.date}</div>
                    <div class="status">${transaction.status}</div>
                    <div class="amount">â‚±${parseFloat(transaction.amount).toFixed(2)}</div>
                `;

                transactionHistory.appendChild(transactionRow);
            });

            // Save updated transactions back to localStorage
            localStorage.setItem("transactions", JSON.stringify(transactions));
            // Clear queueData from localStorage after processing
            localStorage.removeItem("queueData");
        }

        document.addEventListener("DOMContentLoaded", function() {
            displayTransactionHistory();
        });

        var profileIcon = document.getElementById("profileIcon");
        if (profileIcon) {
            profileIcon.addEventListener("click", function (e) {
                window.location.href = "./account-information.html";
            });
        }

        var settingsContainer = document.getElementById("settingsContainer");
        if (settingsContainer) {
            settingsContainer.addEventListener("click", function (e) {
                window.location.href = "./settings.html";
            });
        }

        var paymentContainer = document.getElementById("paymentContainer");
        if (paymentContainer) {
            paymentContainer.addEventListener("click", function (e) {
                window.location.href = "./payment.html";
            });
        }

        var dashboardContainer = document.getElementById("dashboardContainer");
        if (dashboardContainer) {
            dashboardContainer.addEventListener("click", function (e) {
                window.location.href = "./dashboard.html";
            });
        }

        var headerImage = document.getElementById("headerImage");
        if (headerImage) {
            headerImage.addEventListener("click", function (e) {
                window.location.href = "./dashboard.html";
            });
        }
    </script>
</body>
</html>
